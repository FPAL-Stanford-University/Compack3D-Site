<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="http://localhost:1313/docs/">
<link rel="alternate" type="application/rss&#43;xml" href="http://localhost:1313/docs/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Documentation &amp; User Guide | Compack3D</title>
<meta name="description" content="Welcome to Compack3D Welcome to the Compack3D user guide. Compack3D is an open-source project developed at Stanford University and supported by the National Science Foundation. Compack3D is relased under the Apache-2.0 License . This package provides optimized implementations of essential algorithms for rapid development of numerical solvers for partial differential equations.
Why do I need it? Compack3D is a light-weight package, originally designed for computational scientists who use compact finite difference methods (generalized Padé schemes) to accelerate their solvers. It solves the tridiagonal and penta-diagonal systems arising from compact numerical schemes on 3D computational mesh. Compack3D provides efficient solutions for hiearchical parallelization on distributed memory and shared memory and enables affordable large-scale simulations using compact finite difference methods. Compack3D provides both C&#43;&#43; and Fortran APIs, which makes it easy to interface with your own application, even a legacy code.">
<meta property="og:url" content="http://localhost:1313/docs/">
  <meta property="og:site_name" content="Compack3D">
  <meta property="og:title" content="Documentation & User Guide">
  <meta property="og:description" content="Welcome to Compack3D Welcome to the Compack3D user guide. Compack3D is an open-source project developed at Stanford University and supported by the National Science Foundation. Compack3D is relased under the Apache-2.0 License . This package provides optimized implementations of essential algorithms for rapid development of numerical solvers for partial differential equations.
Why do I need it? Compack3D is a light-weight package, originally designed for computational scientists who use compact finite difference methods (generalized Padé schemes) to accelerate their solvers. It solves the tridiagonal and penta-diagonal systems arising from compact numerical schemes on 3D computational mesh. Compack3D provides efficient solutions for hiearchical parallelization on distributed memory and shared memory and enables affordable large-scale simulations using compact finite difference methods. Compack3D provides both C&#43;&#43; and Fortran APIs, which makes it easy to interface with your own application, even a legacy code.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="website">

  <meta itemprop="name" content="Documentation & User Guide">
  <meta itemprop="description" content="Welcome to Compack3D Welcome to the Compack3D user guide. Compack3D is an open-source project developed at Stanford University and supported by the National Science Foundation. Compack3D is relased under the Apache-2.0 License . This package provides optimized implementations of essential algorithms for rapid development of numerical solvers for partial differential equations.
Why do I need it? Compack3D is a light-weight package, originally designed for computational scientists who use compact finite difference methods (generalized Padé schemes) to accelerate their solvers. It solves the tridiagonal and penta-diagonal systems arising from compact numerical schemes on 3D computational mesh. Compack3D provides efficient solutions for hiearchical parallelization on distributed memory and shared memory and enables affordable large-scale simulations using compact finite difference methods. Compack3D provides both C&#43;&#43; and Fortran APIs, which makes it easy to interface with your own application, even a legacy code.">
  <meta itemprop="wordCount" content="326">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Documentation & User Guide">
  <meta name="twitter:description" content="Welcome to Compack3D Welcome to the Compack3D user guide. Compack3D is an open-source project developed at Stanford University and supported by the National Science Foundation. Compack3D is relased under the Apache-2.0 License . This package provides optimized implementations of essential algorithms for rapid development of numerical solvers for partial differential equations.
Why do I need it? Compack3D is a light-weight package, originally designed for computational scientists who use compact finite difference methods (generalized Padé schemes) to accelerate their solvers. It solves the tridiagonal and penta-diagonal systems arising from compact numerical schemes on 3D computational mesh. Compack3D provides efficient solutions for hiearchical parallelization on distributed memory and shared memory and enables affordable large-scale simulations using compact finite difference methods. Compack3D provides both C&#43;&#43; and Fortran APIs, which makes it easy to interface with your own application, even a legacy code.">
<link href="/scss/main.css" rel="stylesheet">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>
<script defer
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="navbar-brand__name">Compack3D</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link active" href="/docs/"><i class='fa-solid fa-book'></i><span>User Guide</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/community/"><i class='fa-solid fa-users'></i><span>Community</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/events/"><i class='fa-solid fa-rss'></i><span>Events</span></a>
      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/docs/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Documentation &amp; User Guide</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-64407d3e6d5ef382426bdfbcae040c6a">Installation</a></li>


    
  
    
    
	
<li>2: <a href="#pg-4be2078a125fe364f7198675d51bc688">Usage</a></li>


    
  
    
    
	
<li>3: <a href="#pg-911293299167d6f4234d22ad00a69909">Algorithm Description</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>4: <a href="#pg-a377c1c7007239be26f179d016a4175c">Benchmark Performance</a></li>


    
  

    </ul>


<div class="content">
      <h2 id="welcome-to-compack3d">Welcome to Compack3D</h2>
<p>Welcome to the <em>Compack3D</em> user guide. <em>Compack3D</em> is an open-source project developed at Stanford University and supported by the National Science Foundation. <em>Compack3D</em> is relased under the <a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="noopener">Apache-2.0 License</a>
. This package provides optimized implementations of essential algorithms for rapid development of numerical solvers for partial differential equations.</p>
<h2 id="why-do-i-need-it">Why do I need it?</h2>
<p><em>Compack3D</em> is a light-weight package, originally designed for computational scientists who use compact finite difference methods (generalized Padé schemes) to accelerate their solvers. It solves the tridiagonal and penta-diagonal systems arising from compact numerical schemes on 3D computational mesh. <em>Compack3D</em> provides efficient solutions for hiearchical parallelization on distributed memory and shared memory and enables affordable large-scale simulations using compact finite difference methods. <em>Compack3D</em> provides both C++ and Fortran APIs, which makes it easy to interface with your own application, even a legacy code.</p>
<h2 id="how-to-cite-our-work">How to cite our work</h2>
<p>If your project benefits from <em>Compack3D</em>, we would appreciate it if you add the following works to your reference list</p>
<ul>
<li>
<p>Song, H., Matsuno, K. V., West, J. R., Subramaniam, A., Ghate, A. S., &amp; Lele, S. K. (2022). <a href="https://doi.org/10.1016/j.jcp.2022.111443" target="_blank" rel="noopener">Scalable parallel linear solver for compact banded systems on heterogeneous architectures</a>
. <em>Journal of Computational Physics</em>, 468, 111443.

<details>
  <summary>See BibTex</summary>
  <div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-tex" data-lang="tex"><span style="display:flex;"><span>@article<span style="color:#204a87">{</span>song2022scalable,
</span></span><span style="display:flex;"><span>  title=<span style="color:#204a87">{</span>Scalable parallel linear solver for compact banded systems on heterogeneous architectures<span style="color:#204a87">}</span>,
</span></span><span style="display:flex;"><span>  author=<span style="color:#204a87">{</span>Song, Hang and Matsuno, Kristen V and West, Jacob R and Subramaniam, Akshay and Ghate, Aditya S and Lele, Sanjiva K<span style="color:#204a87">}</span>,
</span></span><span style="display:flex;"><span>  journal=<span style="color:#204a87">{</span>Journal of Computational Physics<span style="color:#204a87">}</span>,
</span></span><span style="display:flex;"><span>  volume=<span style="color:#204a87">{</span>468<span style="color:#204a87">}</span>,
</span></span><span style="display:flex;"><span>  pages=<span style="color:#204a87">{</span>111443<span style="color:#204a87">}</span>,
</span></span><span style="display:flex;"><span>  year=<span style="color:#204a87">{</span>2022<span style="color:#204a87">}</span>,
</span></span><span style="display:flex;"><span>  publisher=<span style="color:#204a87">{</span>Elsevier<span style="color:#204a87">}</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">}</span>
</span></span></code></pre></div></details>
</p>
</li>
<li>
<p>Song, H., Matsuno, K. V., West, J. R., Subramaniam, A, Ghate, A.S., &amp; Lele, S.K. (2024) <a href="https://www.nas.nasa.gov/pubs/ams/2024/10-24-24.html" target="_blank" rel="noopener">Scalable parallel linear solver for compact banded systems</a>
. In NASA Advanced Modeling and Simulation (AMS) Seminars.</p>
</li>
</ul>
<h2 id="who-to-talk-to">Who to talk to?</h2>
<p>This project is led by Prof. Sanjiva K. Lele and the core development team consists of

<details>
  <summary><strong>Prof. Sanjiva K. Lele</strong></summary>
  <ul>
<li><i class="fa-solid fa-circle-user"></i> Project P.I.</li>
<li><i class="fa-solid fa-building"></i> Stanford University</li>
<li><i class='fa-solid fa-envelope'></i> lele<i class="fa-light fa-at"></i>stanford.edu</li>
</ul>
</details>


<details>
  <summary><strong>Dr. Hang Song</strong></summary>
  <ul>
<li><i class="fa-solid fa-circle-user"></i> Core developer</li>
<li><i class="fa-solid fa-building"></i> Stanford University</li>
<li><i class='fa-solid fa-envelope'></i> songhang<i class="fa-light fa-at"></i>stanford.edu</li>
</ul>
</details>


<details>
  <summary><strong>Andy Wu</strong></summary>
  <ul>
<li><i class="fa-solid fa-circle-user"></i> Developer</li>
<li><i class="fa-solid fa-building"></i> Stanford University</li>
<li><i class='fa-solid fa-envelope'></i> awu1018<i class="fa-light fa-at"></i>stanford.edu</li>
</ul>
</details>


<details>
  <summary><strong>Anjini Chandra</strong></summary>
  <ul>
<li><i class="fa-solid fa-circle-user"></i> Developer</li>
<li><i class="fa-solid fa-building"></i> Stanford University</li>
<li><i class='fa-solid fa-envelope'></i> achandr3<i class="fa-light fa-at"></i>stanford.edu</li>
</ul>
</details>
</p>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-64407d3e6d5ef382426bdfbcae040c6a">1 - Installation</h1>
    
	<h2 id="prerequisites">Prerequisites</h2>
<p><em>Compack3D</em> is implemented in C++ using the C++20 standard. The parallelization follows the &ldquo;MPI+X&rdquo; paradiam. The following packages are required:</p>
<ul>
<li>C++ compiler</li>
<li>&ldquo;X&rdquo; compiler for CUDA or HIP</li>
<li>CMake (minimum version 3.23)</li>
<li>Message Passing Interface (MPI)</li>
</ul>


<div class="alert alert-primary" role="alert">


    The HIP feature is still under development.
The package will be updated soon.

</div>

<h2 id="download-compack3d">Download <em>Compack3D</em></h2>
<p>The source code of <a href="https://github.com/songhanglucky/Compack3D/tree/master" target="_blank" rel="noopener"><em>Compack3D</em></a>
 is hosted on GitHub.
It is highly recommended to obtain the source code using Git.
In order to do this, navigate to the target directory where the <em>Compack3D</em> is expected to be placed.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone git@github.com:songhanglucky/Compack3D.git
</span></span></code></pre></div><h2 id="configuration-using-cmake">Configuration using CMake</h2>
<p><em>Compack3D</em> provids CMake support to build the project.
CMake v3.23 or above is required.
To build <em>Compack3D</em>, first navigate into the <em>Compack3D</em> root directory <code>&lt;path/to&gt;/Compack3D/</code>.
Then create a build directory and navigate into it.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir build <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#204a87">cd</span> build
</span></span></code></pre></div><p>Make sure to load all necessary modules, e.g., compilers, CMake, MPI.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cmake -D&lt;optoinal_var_0&gt;<span style="color:#ce5c00;font-weight:bold">=</span>&lt;val_0&gt; -D&lt;optional_var_1&gt;<span style="color:#ce5c00;font-weight:bold">=</span>&lt;val_1&gt; ..
</span></span></code></pre></div><p>For more detailed usage of CMake, please refer to the <a href="https://cmake.org/documentation/" target="_blank" rel="noopener">official CMake documentation</a>

Available optional variables are listed in the following table.</p>
<table>
  <thead>
      <tr>
          <th>Variable Name</th>
          <th>Type</th>
          <th>Explanation</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>CMAKE_BUILD_TYPE</code></td>
          <td><code>STRING</code></td>
          <td>Valid values are <code>Debug</code>, <code>Release</code>, <code>Profiling</code>, or <code>Help</code>. The <code>Debug</code> mode enables safe launch check and does not enable compiler optimization. Default value is <code>Release</code>.</td>
      </tr>
      <tr>
          <td><code>CMAKE_INSTALL_PREFIX</code></td>
          <td><code>STRING</code></td>
          <td>A valid path with <code>rwx</code> permission. Install root directory. Default is <code>./</code></td>
      </tr>
      <tr>
          <td><code>COMPACK3D_ENABLE_DEVICE_{TYPE}</code></td>
          <td><code>BOOL</code></td>
          <td>Default is <code>OFF</code>. Valid of <code>{TYPE}</code> is <code>CUDA</code> or <code>HIP</code>. Different devices cannot be enabled in one build.</td>
      </tr>
      <tr>
          <td><code>COMPACK3D_DEVICE_ARCH</code></td>
          <td><code>STRING</code></td>
          <td>Specification of the device architecture. Needs to be consistent with the specified device type. Valid values are <code>Default</code>, <code>V100</code>.</td>
      </tr>
      <tr>
          <td><code>COMPACK3D_ENABLE_DEVICE_AWARE_COMM</code></td>
          <td><code>BOOL</code></td>
          <td>If enabled, use GPU-to-GPU communication.</td>
      </tr>
      <tr>
          <td><code>COMPACK3D_BUILD_UNIT_TESTS</code></td>
          <td><code>BOOL</code></td>
          <td>Compile unit tests associated with the specified device.</td>
      </tr>
      <tr>
          <td><code>COMPACK3D_BUILD_BENCHMARK_TESTS</code></td>
          <td><code>BOOL</code></td>
          <td>Compile benchmark tests associated with the specified device.</td>
      </tr>
      <tr>
          <td><code>COMPACK3D_MPI_EXEC_PREFIX</code></td>
          <td><code>STRING</code></td>
          <td>MPI launcher and flags, required for unit tests. This value can be alternatively set by environmental variable <code>COMPACK3D_MPI_EXEC_PREFIX</code>. Default value is <code>mpiexec -n 1</code>, and a warning will be rased.</td>
      </tr>
  </tbody>
</table>
<h2 id="linking-to-your-own-project">Linking to your own project</h2>
<p>We working on it&hellip;</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4be2078a125fe364f7198675d51bc688">2 - Usage</h1>
    
	<p><em>Compack3D</em> is mostly implemented in C++, and it also provides Fortran interfaces using <code>ISO_C_BINDING</code>.
In order to improve the performance, the tridiagonal and penta-diagonal solvers in <em>Compack3D</em> prefactorize the linear systems.
Buffer for distributed communication is also required.
Depending on the system size, grid decomposition strategy, device that supports the solution process, and communication pattern,
the allocation of the buffer variables is application specific.
Additionally, the buffer may be able to reused for solving different linear systems on the same computational grid.
<em>Compack3D</em> supports customized memory allocation and management.
It also provides built-in memory allocators and deallocators.
The tridiagonal and pental-diagonal solvers in <em>Compack3D</em> can be used in either pure function calls or object member function calls.
From the perspective of simplifying the memory management, object member function calls are recommended.</p>
<h2 id="namespace-cmpk">Namespace (<code>::cmpk</code>)</h2>
<p>For C++ programming interface, <em>Compack3D</em> is protected by the namesapce <code>::cmpk</code>.


<div class="alert alert-primary" role="alert">


    In the following context, the base namespace, <code>::cmpk</code>, is assumed.

</div>
</p>
<h2 id="memory-space">Memory space</h2>
<p>The concept of memory space is used in <em>Compack3D</em> to indicate the locality of the data and instruct the kernel launching.
<em>Compack3D</em> defines two types of memory space</p>
<ul>
<li><code>MemSpace::Host</code> host memory</li>
<li><code>MemSpace::Device</code> device memory</li>
</ul>
<p>The host memory (<code>MemSpace::Host</code>) is guaranteed to be accessbile by a CPU thread.
If a GPU is specified as the device, the device memory space (<code>MemSpace::Device</code>) will be the GPU memory.
Otherwise, the device memory is the same as the host memory as degeneration.
Nevertheless, using CPU as the device indicates that a &ldquo;kernel&rdquo; will be launched on CPU with shared-memory parallelism, the execution will be mapped to OpenMP.</p>
<h2 id="high-level-apis">High-level APIs</h2>
<p><em>Compack3D</em> provides high-level application programming interfaces (APIs).
The solvers are wrapped into C++ templated classes.
The data locality and factorization coefficients are automatically managed internally throughout the life time of a solver object.
For efficient memory usage, memory buffers for solvers on the same computational mesh and mesh partition strategy can be shared.
In order to use the high-level APIs, the header file <code>Compack3D_api.h</code> is required.
Some utility functions are provided for memory management are provided.
These utility functions allows the user to have single implementation for various runtime architectures.</p>
<h3 id="memory-management">Memory management</h3>
<p>The memory allocation and deallocations are managed by <code>memAllocArray</code> and <code>memFreeArray</code>, respsectively.
The signatures are provided below:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">template</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">typename</span> <span style="color:#000">MemSpaceType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">typename</span> <span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">memAllocArray</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">**</span> <span style="color:#000">ptr_addr</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>and</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">template</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">typename</span> <span style="color:#000">MemSpaceType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">typename</span> <span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">memFreeArray</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">data</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>where <code>MemSpacetype</code> can be either <code>MemSpace::Host</code> or <code>MemSpace:Device</code>;
and <code>memFreeArray</code> only requires the value of the pointer pointing to the allocated memory address.
<code>memAllocArray</code> takes the address of a pointer as <code>DataType**</code> and a count of memory in the group of <code>sizeof(DataType)</code> as <code>unsigned int</code>.
<code>memAllocArray</code> and <code>memFreeArray</code> only take raw pointers, which do not assume any higher-level data structures.
For a multi-dimensional array, the count is the total number of entries including the padded entries.


<div class="alert alert-primary" role="alert">


    To reduce the chance of causing memory leak, <code>memAllocArray</code> requires that <code>*ptr_addr</code> must be a null pointer, <code>nullptr</code>.
Otherwise, a runtime error will be thrown.

</div>
</p>
<h3 id="deep-copy">Deep copy</h3>
<p>Deep copy of an array can be conducted using the built-in utility functions <code>deepCopy</code>.
<code>deepCopy</code> automatically maps to a proper method for safe deep copy of data from host to host, from device to device, or between host and device.
The signature of <code>deepCopy</code> is</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">template</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">typename</span> <span style="color:#000">DstMemSpaceType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">typename</span> <span style="color:#000">SrcMemSpaceType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">typename</span> <span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">deepCopy</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">dst</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">src</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">count</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>The type arguments <code>DstMemSpaceType</code> and <code>SrcMemSpaceType</code> represent the destination and source memory space types, respectively.
The valid types are <code>MemSpace::Host</code> and <code>MemSpace::Device</code>.
<code>DataType</code> is an atomic data type of the arrays.
The function arguments <code>dst</code> and <code>src</code> are the raw pointers of the destination and source buffer respectively. <code>count</code> is the count of <code>DataType</code> entries.</p>
<h3 id="solver-apis">Solver APIs</h3>
<p>The tridiagonal and penta-diagonal solvers operated on a 3D partitioned computataional mesh are:</p>
<ul>
<li><code>DistTriSolDimI</code> &ndash; solving a tridiagonal system along the dimension <code>i</code>.</li>
<li><code>DistTriSolDimJ</code> &ndash; solving a tridiagonal system along the dimension <code>j</code>.</li>
<li><code>DistTriSolDimK</code> &ndash; solving a tridiagonal system along the dimension <code>k</code>.</li>
<li><code>DistPentaSolDimI</code> &ndash; solving a penta-diagonal system along the dimension <code>i</code>.</li>
<li><code>DistPentaSolDimJ</code> &ndash; solving a penta-diagonal system along the dimension <code>j</code>.</li>
<li><code>DistPentaSolDimK</code> &ndash; solving a penta-diagonal system along the dimension <code>k</code>.</li>
</ul>


<div class="alert alert-primary" role="alert">


    The convention of a 3D dimensional array index is (<code>i</code>, <code>j</code>, <code>k</code>), which holds for both C- and Fortran-order memory layouts.
For the C-order layout, the index <code>k</code> maps to the contiguous memory access,
while for the Fortran-order layout, the index <code>i</code> maps to the contiguous memory access.

</div>

<p>For simplicity, denote <code>DimX</code> be an arbitrary dimension of {<code>DimI</code>, <code>DimJ</code>, <code>DimK</code>}.</p>
<h4 id="construction">Construction</h4>
<p>All the listed solvers do not support default construction.
The signatures of the tridiagonal and penta-diagoanal solves are:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">template</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">typename</span> <span style="color:#000">RealType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">typename</span> <span style="color:#000">RealTypeComm</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">typename</span> <span style="color:#000">MemSpaceType</span><span style="color:#ce5c00;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">DistTriSolDimX</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">RealType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">RealTypeComm</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">MemSpaceType</span><span style="color:#ce5c00;font-weight:bold">&gt;::</span><span style="color:#000">DistTriSolDimX</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">num_grids_i</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">num_grids_j</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">num_grids_k</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">arr_stride_i</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">arr_stride_j</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">MPI_Comm</span> <span style="color:#000">mpi_comm</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">template</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">typename</span> <span style="color:#000">RealType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">typename</span> <span style="color:#000">RealTypeComm</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">typename</span> <span style="color:#000">MemSpaceType</span><span style="color:#ce5c00;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">DistPentaSolDimX</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">RealType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">RealTypeComm</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">MemSpaceType</span><span style="color:#ce5c00;font-weight:bold">&gt;::</span><span style="color:#000">DistPentaSolDimX</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">num_grids_i</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">num_grids_j</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">num_grids_k</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">arr_stride_i</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">unsigned</span> <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">arr_stride_j</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">MPI_Comm</span> <span style="color:#000">mpi_comm</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><p>The construction signature contains the description of the decomposed computational mesh in the local distributed memory partition.
The template argument <code>RealType</code> represents the atomic floating-point (FP) type.
Currently supported types are FP64 and FP32.
The communication between distributed memory partitions includes mixed-precision operations.
The template argument <code>RealTypeComm</code> indicates the reduced-precision FP type.
If <code>RealTypeComm</code> is same as <code>RealType</code>, then no mixed-precision operation will be performed.
<code>RealTypeComm</code> is an optional argument, which is default to <code>RealType</code>.</p>


<div class="alert alert-primary" role="alert">


    The precision of <code>RealTypeComm</code> must be less or equal to that of <code>RealType</code>.
Otherwise, a compile error will be raised.
The mixed-precision operation can, though not is not guaranteed to, result in the higher precision accuracy.
The accuracy depends on the runtime computational mesh size, the mesh partitioning strategy, as well as the linear system itself.
The development is working on the runtime check feature to estimate the magnitude of the final round-off error.

</div>

<p>The template argument <code>MemSpaceType</code> indicates the data locality.
Valid types are <code>MemSpace::Host</code> and <code>MemSpace::Device</code>.
Here the data is referred to the input and output during the solution process.
The <code>MemSpaceType</code> must be consistent with the locality of the shared buffer.
The allocation of all internal buffer is guaranteed to be consistent with the specified <code>MemSpaceType</code>.</p>
<p>The arguments <code>num_grid_i</code>, <code>num_grid_j</code>, and <code>num_grid_k</code>, are number of grid points in the current distributed-memory partition.
These numbers only count for valid grid points. Do not count any padded entries.
The arguments <code>arr_stride_i</code> and <code>arr_stride_j</code> are the memory strides in terms of counts of entries on the linear allocated memory.
These arguments provide instructions of accessing the 3D array from (<code>i</code>, <code>j</code>, <code>k</code>) to (<code>i+1</code>, <code>j</code>, <code>k</code>) and  from (<code>i</code>, <code>j</code>, <code>k</code>) to (<code>i</code>, <code>j+1</code>, <code>k</code>), respectively.</p>
<p>The argument <code>mpi_comm</code> is an MPI sub-communicator that only contains the partitions involved in an individual solution process.
This means that the MPI sub-communicator should only contain the pencil of partitions in along the solve dimension.
See <a href="/docs/algorithms/#overview">the figure of schematics</a>
 for more details.


<div class="alert alert-primary" role="alert">


    The ranks assigned by <code>mpi_comm</code> must be continuous intergers starting from <code>0</code>.
The solution process uses the ranks to determine the data locality in different distributed memory partitions.

</div>
</p>
<h2 id="low-level-apis-use-with-caution">Low-level APIs (use with caution)</h2>
<p>All low-level APIs in <em>Compack3D</em> are included in the high-level APIs.
The high-level APIs provide extensive flexibility for use the solvers in various scenarios.
Although, the low-level APIs offers much more flexibility, it is still highly recommended to use the high-level APIs if sufficient.
Again, it is highly recommended to use the low-level APIs only when it is necessary.</p>
<p>If you have carefully read the previous paragraph still decide to use the low-level APIs, the instructions are listed as follows.
The possibly needed header files are listed below:</p>
<ul>
<li><code>Compack3D_util.h</code> constains all the utility functions</li>
<li><code>Compack3D_tri.h</code> contains all the low-level functions for the tridiagonal solvers</li>
<li><code>Compack3D_penta.h</code> contains all the low-level functions for the penta-diagonal solvers</li>
</ul>
<p>The low-level functions for the tridiagonal and penta-diagonal solvers are protected within the namespace <code>::cmpk::tri</code> and <code>::cmpk::penta</code>, respectively.</p>


<div class="alert alert-primary" role="alert">


    This section is still under construction and will be updated soon.

</div>


</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-911293299167d6f4234d22ad00a69909">3 - Algorithm Description</h1>
    
	<h2 id="overview">Overview</h2>
<p>The algorithm used in the compact banded linear system solvers assumes that the computational grid is decomposed into distributed memory partitions.
During the solution process, a pencil of distributed memory partitions is involved.
A figure below shows an example of solving the linear system in the vertical dimension, and a pencil of four partitions involved in the linear system is higlighted in red.
For numerical schemes that are applied to a periodic domain, the linear systems also contain non-zero cyclic entires.
The linear solvers provided in <em>Compack3D</em> support this mathematical structure.</p>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 560px">
<img class="card-img-top" src="/docs/algorithms/systemAndPartitions_hu_f44ecc7fecbd3b61.png" width="550" height="291">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


Compact banded linear system formulated across 3D partitioned grid. A pencil of partitions involved in the solution process is highlighted in red.

</p>
</figcaption>
</figure>

<p>The algorithm considers hiearchical parallellsms with heterogeneous memory access, and has much lower communication footprint across distributed memory partitions.
These designs make the algorithm suitable for computations using multiple GPUs or multi-core CPUs on the modern high-performance computing architectures.</p>
<h2 id="basic-elimination-patterns">Basic elimination patterns</h2>
<p>The basic elimination pattern used in the compack banded linear solvers in <em>Compack3D</em> follows the cyclic reduction (CR) algorithm (Buzbee, Golub, and Nielson, <em>SIAM J.</em>, 1970) and its fully parallel variant known as the parapllel cyclic reduction (PCR) algorithm.
In each elimination step, the original off-diagonal entries in a row are eliminated by the neigboring rows.
For a tridiagonal system, two neighboring rows participate in each elimination process, and for a penta-diagonal system, each elimination step involves four neighboring rows.
In general, as the result after each elimination step, the row has the same number of off-diagonal entries but staggered with zero entries.
The staggered zero entries indicate that the current row has even or odd decoupling from the original system,
<em>i.e.</em>, if the current row is an even-number row, it only couples with other even-number rows in the system,
and if the current row is an odd-number row, it only couples with other odd-number rows in the system.
The schematics of the basic elimination processes for a tridiagonal and penta-diagonal systems are shown in the following figure.</p>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 710px">
<img class="card-img-top" src="/docs/algorithms/eliminationPattern_hu_ad1e16085bd6a386.png" width="700" height="256">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


Basic elmination process for tridiagonal systems (left) and penta-diagonal system (right) generalized from the cyclic reduction algorithm (Buzbee, Golub, and Nielson, SIAM J., 1970).

</p>
</figcaption>
</figure>

<h2 id="distributed-parallelism">Distributed parallelism</h2>
<p>From a view of the entire pencil of distributed memory partitions involved in the linear system, the solution process is equivalent to conducting parallel block Gaussian elimination, as shown in the figure below.
As the outcome of the block Gaussian elimination, a block upper triangular system is obtained.
The last diagonal block is an independent small block tridiagonal formulated across distributed memory partitions, known as the reduced system.
Once the reduced system is solved, the remaining systems can be then solved in parallel within each distributed memory partition.
The reduced system is solved using the block PCR across the distributed memory partitions, and other diagonal blocks are solved using PCR with shared-memory parallelism.</p>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 710px">
<img class="card-img-top" src="/docs/algorithms/parallelGE_hu_ca774f93b758d85d.png" width="700" height="220">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


Solution process viewing from distributed memory partitions analogous to parallel block Gaussian elimination:
(left) original system with further logical partitions,
(middle) logical collumn and row permutations,
and (right) resulting structure after block Gaussian elimination.
The reduced system is formulated across distributed memory partitions as the last diagonal block.

</p>
</figcaption>
</figure>

<p>The reduced system is block tridiagonal formulated across the distributed memory partitions.
The block size is equal to the number of off-diagonal entries on each side.
The total size of the reduced system is equal to the number of the distributed-memory partitions participated in the solution process.
The non-zero cyclic entry blocks exist in the reduced system if the original system is also cyclic.
Traditional PCR approach naturally solves a cyclic system of a power-of-two size or a non-cyclic system.
If a reduced system is cyclic and whose size is not a power-of-two, <em>Compack3D</em> applies the method of attaching and reattaching to avoid extra communication or non-parallelizable steps in the traiditional methods.
A schematic of the solution process for an 11-by-11 cyclic reduced system is shown in the figure blow.</p>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 710px">
<img class="card-img-top" src="/docs/algorithms/reducedSys_hu_d417ec47e36b8e6c.png" width="700" height="314">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


An example of solving a 11x11 reduced system using parallel cyclic reduction with the method of detaching and reattaching.

</p>
</figcaption>
</figure>

<h2 id="related-publications">Related publications</h2>
<ul>
<li>
<p>Song, H., Matsuno, K. V., West, J. R., Subramaniam, A., Ghate, A. S., &amp; Lele, S. K. (2022). <a href="https://doi.org/10.1016/j.jcp.2022.111443" target="_blank" rel="noopener">Scalable parallel linear solver for compact banded systems on heterogeneous architectures</a>
. <em>Journal of Computational Physics</em>, 468, 111443.</p>
</li>
<li>
<p>Song, H., Matsuno, K. V., West, J. R., Subramaniam, A, Ghate, A.S., &amp; Lele, S.K. (2024) <a href="https://www.nas.nasa.gov/pubs/ams/2024/10-24-24.html" target="_blank" rel="noopener">Scalable parallel linear solver for compact banded systems</a>
. In NASA Advanced Modeling and Simulation (AMS) Seminars.</p>
</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a377c1c7007239be26f179d016a4175c">4 - Benchmark Performance</h1>
    
	

<div class="pageinfo pageinfo-primary">
<p>Benchmark performance</p>

</div>


</div>



    
	
  



          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        
      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        
      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2025
    <span class="td-footer__authors">Compack3D Development Team at Stanford University</span></span><span class="td-footer__all_rights_reserved">All Rights Reserved</span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css"
      integrity="sha512-r2+FkHzf1u0+SQbZOoIz2RxWOIWfdEzRuYybGjzKq18jG9zaSfEy9s3+jMqG/zPtRor/q4qaUCYQpmSjTw8M+g==" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js"
        integrity="sha512-INps9zQ2GUEMCQD7xiZQbGUVnqnzEvlynVy6eqcTcHN4+aQiLo9/uaQqckDpdJ8Zm3M0QBs+Pktg4pz0kEklUg=="
        crossorigin="anonymous">
</script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js"
       integrity="sha512-YJVxTjqttjsU3cSvaTRqsSl0wbRgZUNF+NGGCgto/MUbIvaLdXQzGTCQu4CvyJZbZctgflVB0PXw9LLmTWm5/w==" crossorigin="anonymous"
       onload='renderMathInElement(document.body, {"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"},{"display":true,"left":"\\[","right":"\\]"}],"errorcolor":"#CD5C5C","throwonerror":false});'>
</script>
<script src="/js/main.js"></script>
<script defer src="/js/click-to-copy.js" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>
